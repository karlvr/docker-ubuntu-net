#Alias /assets /srv/www/letterboxd/assets
DirectoryIndex index.sm index.html

# Maintenance
Alias /_maint /opt/letterboxd/www/maint
ErrorDocument 503 /_maint/index.html

# Stats
#Alias /_stats /srv/www/letterboxd/stats

# JK Status
JkMount /jk-status status
<Location /jk-status>
    Order deny,allow
    Deny from all
    Allow from 121.98.151.165

    AuthType Basic
    AuthName "Server"
    AuthUserFile /opt/letterboxd/etc/apache2/admin.htpasswd
    Require valid-user

    Satisfy any
</Location>

<Location "/WEB-INF/">
deny from all
</Location>

RewriteEngine On
RewriteCond %{HTTP_HOST} boxd.it
RewriteRule /robots.txt /robots-direct.txt [L,PT]
RewriteCond %{HTTP_HOST} boxd.it
RewriteCond %{REQUEST_URI} !^/apple-app-site-association$
RewriteRule ^/(.*)$      /s/boxd-it?code=$1      [L,PT]

# Rewrite for js compressor sets, used by embeds
RewriteRule ^/js/c/([^/]+)(/(.*))? /static/js/$1.min.js?v=$3 [PT]

# P3P for cross-domain cookies
Header append P3P "policyref=\"http://letterboxd.com/w3c/p3p.xml\", CP=\"CAO CUR ADM DEV TAI OUR IND ONL UNI COM NAV INT\""

# Apple Universal Links
<Location "/apple-app-site-association">
Header set Content-Type "application/json"
</Location>
